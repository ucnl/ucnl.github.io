---
layout: post
title: Почему все затухает?
---

### Приветствую, глубокоуважаемые!

> _"Кто не занимается обследованием и изучением, тот не имеет права высказываться."_ </br> (С) Мао Цзэдун. Период до основания КНР

Вспомнил я тут о сокровенном, и даже сакральном эмпирическом знании. Не считая себя вправе скрывать его от широкой общественности, излагаю.

## Автобиографичная история

Дело было году наверное в 2010-ом, в бытность мою еще научным сотрудником НИИ. В курилке случился у меня диалог с одним из наших учителей - Игорем Владимировичем Бобровским. 
Игорь Владимирович, пожалуй, стал для меня (уверен, и для моих коллег тоже) образцом ученого: за скромностью и простотой речи скрывалось фантастически глубокое советское образование, богатейший опыт и завидная острота мысли. Он никогда не использовал сложных терминов и формулировок, если только без них было совсем не обойтись.

Поясню на контрасте:  
Когда я слышу что-то вроде "Я иду на горизонте", "Дифферентуюсь", "Мы на нцатом шпангоуте" - я делаю вывод, что скорее всего, передо мной человек с фрагментарными знаниями, который спешит пустить пыль в глаза и удивить всех где-то ухвачеными терминами и профжаргоном.  

Когда я впервые услышал "Дифферентуюсь" я начинал вспоминать, что есть такие понятия как "Крен" и "Дифферент". Крен бывает на борт, "Рыскание" - это когда самолет или судно поворачивают нос в горизонтальной плоскости, а "Дифферент" это, стало быть, наклон на нос или корму. Судно-то жесткое, если есть дифферент на нос, то на корму он тоже есть, только с другим знаком. Наверное, подумал я, речь идет о выравнивании судна, возник дифферент и его надо устранить или наоборт - сделать. А как спросить - ведь все же тогда поймут, что я не знаю что такое "Дифферентуюсь"!

Когда я впервые услышал "мы на нцатом шпангоуте" это поистине повергло меня в раздумья: что такое шпангоут, еще примерно понятно, но откуда они начинают отсчитываться? От кормы, носа или от середины? Сколько их вообще бывает? "нцатый" - это где? Ближе к носу или корме? Какое расстояние между шпангоутами? Оно всегда одинаковое или разное? А сколько шпангоутов вообще у судна, о котором идет речь? Кстати, а о каком судне речь?

Так вот, Бобровский никогда так не говорил. Напротив, он всегда изьяснялся так, чтобы всем было понятно.
Когда я в какой-то статье использовал термин "релевантный", он, вычитывая ее, улыбнулся и сказал: "Релевантный. Красивое слово. А мне вот еще нравится слово "Астролябия" - тоже красивое". Умел тонко намекнуть.

Я тогда совсем мало что знал по нашей гидроакустической теме, но то, что дальность гидроакустической связи зависит от частоты я понимал, не понимал только как _именно_. Собственно, и сейчас я не могу сказать, что понимаю это настолько, насколько мне хотелось бы.

На мой вопрос, есть ли какая-то средняя оценка, на какую максимальную дальность связи можно рассчитывать в идеальных условиях, исходя только из несущей частоты сигнала он ответил утвердительно: да мол, есть простая формула. Я постарался запомнить простую формулу и вернувшись в кабинет сразу записал её: там буквально два действия и один параметр - частота. Он еще добавил: "Она простая, можно самому вывести". Я с тех пор иногда думаю об этом, стоит ли упоминать, что сам я ничего так и не вывел? Впрочем, вернемся к формуле чуть позже.

## Копнем чуть _глубже_

### 1. Распад и затухание

> _"То потухнет, то погаснет"_ </br> Фразеологизм

Как прикинуть, на какую максимальную дальность можно рассчитывать?
Абстрагируемся сейчас от других условий распространения сигнала вроде многолучевого распространения, конструкции приемной и передающей антенн и прочего.

Мы знаем, что затухание звуковых колебаний в воде зависит о частоты. Существет ощутимое число работ, посвященных получению эмпирических зависимостей, по которым можно рассчитать коэффициент поглощения, вот несколько из них, по именам авторов:

- Ainslie & McColm, 1998[^1]
- Fisher & Simmons, 1977[^2]
- Francois & Garrison, 1982[^3][^4]

Итак, чтобы звук затухал, у него нужно отбирать энергию. Есть два с половиной механизма, как у звуковой волны в морской воде отбирается энергия. Эти механизмы доступно описаны в работе[^1].

#### 1.1. Поглощение за счет вязкости воды

На частотах выше 100 кГц движение частиц под воздействием звуковых колебаний производит тепло за счет вязкого трения. При прохождении каждого последующего отрезка расстояния потеря энергии растет экспоненциально. Поэтому удобно использовать логарифмическую шкалу.

Как правило, коэффициент поглощения $α$ измеряется в дБ/км. 

Какая часть энергии у волны останется от исходной $E$ при заданном $α$ на расстоянии $r$ от источника? Вот такая:

$$E_r = E·\left( 10^{-\frac{αr}{20}}\right)^2  $$

Например, если **α** = 1 дБ/км, это значит, что на каждом пройденном километре энергия звуковой волны уменьшается на 21%:

Согласно[^1] коэффициент $α$ зависит от частоты звукового колебания $f$, температуры воды $T$ и давления или глубины $z$. Конечно, перевод давления в глубину в некоторой степени зависит от других параметров, но эффект достаточно мал для данной задачи и для рассчета коэффициента используется глубина $z$ в километрах.

Формула для рассчета коэффициента поглощения в пресной воде выглядит следующим образом:

$$α = 0.00049f^2e^{-(T/27+z/17)} $$

Видно, что коэффициент поглощения растет пропорционально квадрату частоты $f$, поэтому на частотах выше 1 МГц в качестве единиц измерения используют уже дБ/м. А на слышимых частотах эффект весьма незначительный. Обращаем внимание, что при увеличении глубины и/или температуры, коэффициент поглощения уменьшается, так как показатель степени отрицательный.

#### 1.2. Поглощение растворенными веществами

В морской воде растворено множество различных веществ, молекулы которых имеют более одного устойчивого состояния. Переход между этими состояниями происходит при изменении давления и может сопровождаться выделением тепла, а следственно и потерей энергии. Сам эффект называется _химической релаксацией_ и характеризуется временем или частотой релаксации. 
Поскольку переходы между состояниями молекул происходят относительно медленно, для высокочастотных колебаний эффект химической релаксации достаточно мал и наоборт, проявляется в основном на низких и средних частотах.

В работе[^1] указывает два основных компонента морской воды, ответственных за поглощение - это борная кислота (H<sub>3</sub>BO<sub>3</sub>) и сульфат магния (MgSO<sub>4</sub>),  частоты релаксации которых соотстветственно:

$$f_1 = 0.78\sqrt{(S/35)}·e^{T/26} $$

$$f_2 = 42e^{T/17} $$

Обе частоты зависят от температуры **T**, но только частота релаксации борной кислоты зависит от солености воды **S**. Соленость воды измеряется электропроводностью воды, которая, в свою очередь обусловлена наличием ионов. Хотя большая часть ионов типо ионов хлора и натрия и не влияет напрямую на поглощение звуковых колебаний, они ответственны за поглощение электромагнитных колебаний.

Общая форма зависимости коэффициента затухания в следствие механизма химической релаксации имеет такой вид:

$$α = \frac{A_x·f_x·f^2}{f_x^2 + f} $$

А обобщенная формула для рассчета коэффициента затухания с учетом затухания в пресной воде и механизма химической релаксации согласно работе[^1] выглядит так:

$$α = 0.106 \frac{f_1·f^2}{f^2 + f_1^2} · e^{(pH-8)/0.56} + 0.52(1 + \frac{T}{43})(\frac{S}{35})\frac{f_2f^2}{f^2+f_2^2}·e^{-z/6} + 0.00049f^2e^{-(T/27+z/17)}$$

Хорошо. Теперь мы примерно знаем, как звук затухает в среде. Но это не единственное явление, которое нужно учесть, чтобы прикинуть примерную дальность связи. А я напомню - именно это мы хотим сделать.

### 2. Расширение фронта волны

Если с фанатизмом надувать резиновый шарик - он лопнет. Потому что он растягивается от давления газа внутри и истончается. 
Это хорошая аналогия процесса, который мы должны учесть - расширение фронта волны.

Из школьного курса физики мы помним, что

_Интенсивность света (то есть энергия, приходящаяся на единицу площади в единицу времени) или **других линейных волн**, исходящих от точечного источника, обратно пропорциональна квадрату расстояния от источника._

То есть, чисто из-за того, что фронт волны расширяется, энергия, которую можно собрать с единицы поверхности (скажем, с поверхности приемной антенны) уменьшается с расстоянием. 

Эти потери, связанные с _геометрическим распространением_, для простоты назовем их просто _геометрическими_.

Будем учитывать их при помощи еще одного коэффициента - $α_g$, рассчитывается он так:

$$α_g = k·10·log_{10}(r) $$

$r$ - здесь расстояние в километрах, а $k$ - коэффициент, задающий характер распространения фронта,  $k=2$ для сферического фронта,  $k=1$ - для цилиндрического.
Дело в том, что в подавляющем числе случаев дальность связи много больше глубины водоема, и "сфера" сверху ограничивается поверхностью воды, а снизу дном. Так и получается "цилиндр". 

### 3. Зафиксируем убытки

> _"не надо булочной, не надо справочной. Вот моя планета. УЗМ 247 в тентуре. Галактика Бета в спирали. Вот машинка перемещения в пространстве. Какой контакт мне нажимать, чтобы домой переместиться?"_ (С) Кин-Дза-Дза

Итак. Мы рассмотрели два основных фактора, влияющих на дальность гидроакустической связи. Как то:
- затухание в среде
- геометрическое расширение фронта волны

Оба фактора учитываются коэффициентами. Как теперь посчитать дальность? Что на что умножить, где разделить? "Какой контакт нажимать?"
Не все сразу. Продолжим.

Суммарные потери $α_t$ связанные с двумя вышеперечисленными факторами определяются так:

$$α_t = α_g + α$$

И более подробно:

$$α_t = k·10·log_{10}(r) + 0.001·α·r $$

Коэффициент 0.001 стоит здесь для перевода из дБ/км в дБ/м.

Теперь, если наша передающая антенна развивает какое-то давление $P_{tx}$, давление шума в точке приема $P_N$ и требуемое соотношение сигнал-шум в точке приема $SNR$, мы можем записать условие приема, в котором расстояние $r$ содержится как параметр:

$$P_{tx}·10^{\frac{α}{10}}=P_N·SNR $$

Теперь подставим в это равенство $α$:

$$10^{\frac{-k·log(r)}{10·log(10)-0.001·α·r}}=\frac{P_N·SNR}{P_{tx}}$$

Вот отсюда и предполагается получить желаемое $r$ при известных остальных параметрах. Я не знаю как решить такое уравнение аналитически, поэтому могу лишь привести численное решение: [Simple sound propagation distance estimation](https://docs.unavlab.com/online_utils/simple_prop_distance_estimation.html).

### 3. От сложного к простому и обратно

У читателя уже могло возникнуть подозрение, что формула выше никак не подходит под описания "есть простая формула", "там буквально два действия и один параметр - частота", "Она простая, можно самому вывести".

Формула, о которой я упомянул в начале выглядит так:

<details>
  <summary>Узреть формулу</summary>
$$d_{km} = \left( \frac{40}{f_{kHz}} \right) ^\frac{3}{2}$$  
</details>

Я даже нашел фотографию листка, на котором когда-то записал формулу.

<details>
  <summary>Фотофакт</summary>
  
![1](../images/equation_from_bobrovsky.png)
  
</details>

Как видите, записал я ее неправильно - число перепутал. Восстановить удалось при помощи знания двух точек: 20 кГц - это 3 км, а 10 кГц - 8 км.

График в диапазоне от 1 до 100 кГц представлен на рисунке ниже. "Волшебные" точки на 20 и 10 кГц отмечены кружками.

![2](../images/equation_from_bobrovsky1.png)

Логично теперь будет попробовать наложить на этот график результаты, которые получаются из "длинной формулы".















<details>
  <summary>P.S.</summary>
  
Как писалась статья. 
Сначала я думал просто кратенько, всем трем человекам, которым это интересно, рассказать про феномен формулы, которая в принципе подтверждается реальностью и непонятно откуда взялась, снабдив рассказ автобиографичным антуражем.
К сожалению, Игоря Владимировича уже не спросишь, и приходится искать фактически на -слух- ощупь. 
  
Вы же помните сюжет "Попытки к бегству" Стругацких? Если нет, я напомню: на одной планете, куда прилетели герои, есть некий конвейер: из одной дыры в земле неведомая техника выходит, движется по земле, и исчезает в другой дыре в земле. Туземцы пытаются овладеть исскуством управления техникой методом тыка - буквально - силами заключенных техника изымается с конвейера и подвергается исследованию методом научного тыка: сунули палец в дырку согласно прилагаемому рисунку, машина зарычала и поехала направо, проехала такое-то расстояние и встала.
  
Меня не покидает ощущение, что мы в каком-то смысле похожи на этих туземцев, и данная статья есть ни что иное, как робкая попытка размежеваться с туземцами. Разойтись по разным мирам не вышло, скажем так: мы просто сделали пару шагов в сторону.

Написание растянулось на неделю. Пришлось прочитать книгу[^5], не найти в ней ничего нового, написать мат модель и основательно ее поковвырять. Поэтому в списке авторов я не могу оставить одного себя: я напряг своих коллег и их вклад неоценим. 
  
</details>


[^1]: [Ainslie M. A., McColm J. G., "A simplified formula for viscous and chemical absorption in sea water", Journal of the Acoustical Society of America, 103(3), 1671-1672, 1998.](https://asa.scitation.org/doi/10.1121/1.421258)
[^2]: [Fisher F. H., Simmons V. P., "Sound absorption in seawater", Journal of the Acoustical Society of America, 62, 558-564, 1977.](https://asa.scitation.org/doi/abs/10.1121/1.386278)
[^3]: [Francois R. E., Garrison G. R., "Sound absorption based on ocean measurements: Part I: Pure water and magnesium sulfate contributions", Journal of the Acoustical Society of America, 72(3), 896-907, 1982.](https://asa.scitation.org/doi/abs/10.1121/1.388170)
[^4]: [Francois, R.E., & Garrison, G.R. (1982). Sound absorption based on ocean measurements. Part II: Boric acid contribution and equation for total absorption. Journal of the Acoustical Society of America, 72, 1879-1890.](https://asa.scitation.org/doi/10.1121/1.388673)
[^5]: [Матвиенко В.Н., Тарасюк Ю. Ф., Дальность действия гидроакустических средств](http://publ.lib.ru/ARCHIVES/B/%27%27Biblioteka_injenera-gidroakustika%27%27/%CC%E0%F2%E2%E8%E5%ED%EA%EE%20%C2.%CD.,%20%D2%E0%F0%E0%F1%FE%EA%20%DE.%D4._%20%C4%E0%EB%FC%ED%EE%F1%F2%FC%20%E4%E5%E9%F1%F2%E2%E8%FF%20%E3%E8%E4%F0%EE%E0%EA%F3%F1%F2%E8%F7%E5%F1%EA%E8%F5%20%F1%F0%E5%E4%F1%F2%E2.(1981).pdf)


Ваши, до _глубины_ души  
[@AlekUnderwater](https://www.github.com/AlekUnderwater)  
[@Vital792](https://github.com/vital792)  
[@AndreyUnderwater](https://github.com/AndreyUnderwater)  
[@StDmitriev](https://github.com/StDmitriev)  



