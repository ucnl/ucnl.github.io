
[Главная](/README_RU) ❯ [Наши проекты для образования](/educational_projects_ru) ❯ **ACoubes: Руководство пользователя**

<div style="page-break-after: always;"></div>

| ![logo](/documentation/sm_logo.png) | ![image](https://github.com/user-attachments/assets/f9be473c-561b-4536-8c0b-7ab44e6598aa) |
| :---: | ---: |
| [www.unavlab.com](https://www.unavlab.com/) <br/> [support@unavlab.com](mailto:support@unavlab.com) | **A<sup>3</sup>S** **ACoubes** <br/> Руководство пользователя |


# Семейство устройств **A<sup>3</sup>S** <br/> Руководство пользователя

<div style="page-break-after: always;"></div>

## Что это, кому и зачем может быть нужно?

В первую очередь **ACubes** задумывался для применения в сфере образования и подготовки инженерных кадров. 

**A<sup>3</sup>S** или **ACubes** или "Акустические кубики" - это конструктор, набор из элементарных функциональных элементов, на основе которых можно создавать макеты практически любых типов гидроакустических навигационных систем и систем связи:

- простейшие системы передачи цифровой информации - гидроакустические модемы
- системы для беспроводной передачи голоса
- фазированные антенные решетки, а на их основе и ультракороткобазисные (USBL) навигационные системы с маяками-ответчиками
- длиннобазисные, короткобазисные, а также системы с синтезированной измерительной базой
- системы телеуправления
- системы сетевого мониторинга

"Кубики" берут на себя вопросы связанные с преобразованием цифрового сигнала в гидроакустический и обратно, позволяя пользователю сконцентрироваться на решении своих прикладных задач - разработке оригинальных навигационных алгоритмов или алгоритмов помехоустойчивого кодирования, сетевых протоколов и схем взаимодействия. Как правило, для этих целей не требуются ни сверхминиатюрность, ни высокая мощность, ни рекордная дальность - требуется _простота, надежность и доступность_ - это мы и постарались заложить в основу, при создании этой линейки устройств.


## Коробка с кубиками

Мы осознанно не ограничиваем список самих "кубиков", потому что он изначально задуман, как _пополняемый_. Он будет строиться из разных сценариев применения, например, сборка антенной решетки или приемо-передатчика для измерения наклонной дальности. 

### A<sup>3</sup>T и A<sup>3</sup>R 
Это импульсный одноканальный (одночастотный) передатчик и одночастотный приемник. 

Передатчик [A<sup>3</sup>T](A3T_Datasheet_ru.md) излучает импульсы фиксированной частоты и длительности при изменении состояния на своем цифровой входе, которым управляет пользователь. 
Приемник [A<sup>3</sup>R](A3R_Datasheet_ru.md) может улавливать эти импульсы и передавать пользователю, изменяя состояние своего цифрового выхода.

Эти два устройства спроектированы таким образом, что могут объединяться в стек и использовать общую приемопередающую антенну, например, [RT-1.332820-1](https://docs.unavlab.com/documentation/RU/Transducers/RT_1_332820_1_Specification_ru.html). В таком виде получится приемопередатчик. 

Если выход приемника подключить ко входу передатчика, получится маяк-ответчик - принятый сигнал сразу же передается на вход передатчика, который излучает ответный гидроакустический сигнал и вся связка работает как "эхо". При помощи данной схема можно измерять, например, двойное время распространения между запрашивающим и маяком-ответчиком, а следовательно и наклонную дальность.

Разъемы, смонтированные по длинным краям плат являются, по сути, шиной, на которую можно объединить один передатчик и до 12 приемников. При этом выходы всех приемников будут доступны на свободном разъеме. 

Таким образом можно строить и изучать разные конфигурации антенных решеток. В случае, если 12-ти элементной антненной решетки мало, ничто не запрещает использовать сколько угодно стеков, в каждом из которых может быть до 12 модулей A<sup>3</sup>R. 

Для того, чтобы удобно объединить до 24 приемников есть специальная кросс-плата A<sup>3</sup>R-CB2. И конечно, никто не запрещает использование любого числа таких плат.

### О гидроакустических антеннах

Для использования с модулями **A<sup>3</sup>S** могут использоваться антенны двух типов - приемопередающие, которые можно использовать как с модулями [A<sup>3</sup>R](A3R_Datasheet_ru.md), так и с модулями [A<sup>3</sup>T](A3T_Datasheet_ru.md), так и чисто приемные, подходящие для работы только с модулями [A<sup>3</sup>R](A3R_Datasheet_ru.md).

Зачастую, если от конкретного устройства требуется только приемная функция, целесообразно использовать приемную антенну, т.к. она, во-первых, дешевле, а во-вторых, меньше по габаритам и массе.

Приемные антенны [R-1.d3505-1](/documentation/RU/Transducers/R_1.d3505_1_Specification_ru.md) специально разработаны для использования с модулями [A<sup>3</sup>R](A3R_Datasheet_ru.md) и имеют специальные крепления для построения антенных решеток, при многоканальном приеме.

| ![image](https://github.com/user-attachments/assets/850006dd-7430-472e-9dc8-82bf3dfe48e2) |
| :---: |
| |

В качестве приемопередающей антенны (или просто в качестве передающей) могут быть использованы все приемопередающие антенны, производимые лабораторией подводной связи и навигации:

- [RT-1.332820-1](/documentation/RU/Transducers/RT_1_332820_1_Specification_ru.md) - самое доступное и малогарабритное решение
- [RT-2.332820-1](/documentation/RU/Transducers/RT_2_332820_1_Specification_ru.html) - свешиваемая антенна для надводного оборудования на основе двух пьезоэлементов
- [RT-1.524525-1](/documentation/RU/Transducers/RT-1.524525-1_specification_ru.html) - антенна с увеличенной чувствительностью

Общие правила применения гидроакустических антенн достаточно просты:
- к антеннам не следует прилагать ударных нагрузок или неравномерного нагружения
- при креплении, антенны, имеющие крепежный паз должны крепиться только за него
- не допускается механическое перекрытие рабочей поверхности антенны
- при подключении к электронным модулям желательно снять возможный заряд с антенны, закоротив ее выводы

Не стоит использовать агрессивные растворители типа изопропанола или ацетона для очистки поверхностей антенн или кабелей, особенно тех, покрытие которых выполнено из полиуретана.
В остальном, антенны достаточно просты в обслуживании и долговечны.

### Сценарий №1 - Передаем и принемаем 

Самый простой сценарий, в которм задействованы один приемник и один передатчик. 

#### Требуемый набор оборудования

| №    | Наименование | Количество | Примечание |
| :--- | :--- | :--- | :--- |
| 1    | Модуль [A<sup>3</sup>R](A3R_Datasheet_ru.md) | 1 |  |
| 2    | Модуль [A<sup>3</sup>T](A3T_Datasheet_ru.md) | 1 |  |
| 3    | Антенна приемная [R-1.d3505-1](/documentation/RU/Transducers/R_1.d3505_1_Specification_ru.md) | 1 |  |
| 4    | Антенна приемопередающая [RT-1.332820-1](/documentation/RU/Transducers/RT_1_332820_1_Specification_ru.md) | 1 |  |
| 5    | Любая плата с МК, например, Arduino Nano | 2 | Плату для инициации передачи можно заменить кнопкой |
| 6    | Провода Dupont Female-Female или Male-Female, 25+ см | 4 | |

Сначала необходимо подключить гидроакустические антенны к модулям. 
Приемную [R-1.d3505-1](/documentation/RU/Transducers/R_1.d3505_1_Specification_ru.md) к [A<sup>3</sup>R](A3R_Datasheet_ru.md):

| ![image](https://github.com/user-attachments/assets/7cedae37-16d1-4a18-8254-a32e16ff09b4) |
| :---: |
| |

и приемопередающую [RT-1.332820-1](/documentation/RU/Transducers/RT_1_332820_1_Specification_ru.md) к [A<sup>3</sup>T](A3T_Datasheet_ru.md):

| ![image](https://github.com/user-attachments/assets/c3f2d99a-9efd-4d3a-8e49-2add970014aa) |
| :---: |
| |

Инициация передачи на плате [A<sup>3</sup>T](A3T_Datasheet_ru.md) осуществляется изменением логического уровня на пине 4 (разъем XS2) с высокого на низкой, т.е. подтяжкой его к земле (GND), которая присутствует в изобилии на разъеме XS2 - это все нечетные пины. 
Таким образом, для того, чтобы плата излучила сигнал требуется соединить пин 4 c любым нечетным пином на этом же разъеме, например, с пином 3. 

Это можно сделать при помощи обычной кнопки, или платы с МК. Вот пример простого скетча для Arduino, который переключает пин D4 в низкий логический уровень на 10 мс раз в секунду:

<details>
  <summary>Скетч №1 - Инициация передачи 1 раз в секунду</summary>
  
```c
/* 
 * На пине A3T_TX_ENGAGE_PIN генерирует уровень A3T_TX_ACTIVE_STATE на DURATION_TKS микросекунд
 * через каждые PERIOD_TKS микросекунд. Изменение дублируется на встроенный светодиод
*/

#define A3T_TX_ENGAGE_PIN     (4)     // Этот пин необходимо соединить с пином 4 (разъем XS2) на модуле передатчика
                                      // Так же необходимо соединить пин GND на Arduino с пином 3 (разъем XS2)
#define A3T_TX_ACTIVE_STATE   (LOW)
#define A3T_TX_INACTIVE_STATE (HIGH)
#define LED_PIN               (13)
#define DURATION_TKS          (10000)
#define PERIOD_TKS            (1000000 - DURATION_TKS)

bool state;
uint32_t switch_tks;
uint32_t tks;

void setup() {
  pinMode(LED_PIN, OUTPUT);
  pinMode(A3T_TX_ENGAGE_PIN, OUTPUT);
  digitalWrite(A3T_TX_ENGAGE_PIN, A3T_TX_INACTIVE_STATE);

  for (int i = 0; i < 10; i++) {
    digitalWrite(LED_PIN, HIGH);
    delay(100);
    digitalWrite(LED_PIN, LOW);
    delay(100);
  }
}

void loop() {  

  tks = micros();

  if (state) {
    if (tks - switch_tks > DURATION_TKS) {
      digitalWrite(A3T_TX_ENGAGE_PIN, A3T_TX_INACTIVE_STATE);
      digitalWrite(LED_PIN, LOW);
      switch_tks = tks;
      state = false;
    }
  } else {
    if (tks - switch_tks > PERIOD_TKS) {        
      digitalWrite(A3T_TX_ENGAGE_PIN, A3T_TX_ACTIVE_STATE);
      digitalWrite(LED_PIN, HIGH);
      switch_tks = tks;
      state = true;
    }
  }
}
```
</details>

После перевода пина 4 в состояние низкого логического уровня модуль излучит акустический сигнал. Повторное излучение возможно не ранее чем через 40 мсек.

Если при этом модуль приемника детектирует переданный сигнал, он переведет пин 1 на разъеме XS3 в состояние низкого логического уровня на 2 мсек. 
В этом примере, факт приема сигнала будем определять при помощи платы Arduino Nano, но при наличии осциллографа в этом можно легко убедиться и без платы с микроконтроллером.

<details>
  <summary>Скетч №2 - Зажигаем светодиод по факту приема акустического сигнала</summary>

```c
/* По внешнему прерыванию на A3R_STATE_PIN (по спаду) включается встроенный светодиод, который гаснет через 
 * LED_DURATION_TKS микросекунд
*/

#define A3R_STATE_PIN    (2)      // Этот пин необходимо соединить с пином 1 (разъем XS3) на модуле приемника
                                  // Так же необходимо соединить пин GND на Arduino с пином 1 на модуле приемника
#define LED_PIN          (13)
#define LED_DURATION_TKS (10000)

bool led_state;
uint32_t led_on_tks;
uint32_t tks;

void a3r_state_changed_interrupt_handler() {

  led_state = true;
  digitalWrite(LED_PIN, HIGH);
  led_on_tks = micros();
}

void setup() {
  
  pinMode(LED_PIN, OUTPUT);
  pinMode(A3R_STATE_PIN, INPUT);
  attachInterrupt(digitalPinToInterrupt(A3R_STATE_PIN), a3r_state_changed_interrupt_handler, FALLING);

  for (int i = 0; i < 10; i++) {
    digitalWrite(LED_PIN, HIGH);
    delay(100);
    digitalWrite(LED_PIN, LOW);
    delay(100);
  }
}

void loop() {  

  if (led_state) {
    tks = micros();
    if (tks - led_on_tks > LED_DURATION_TKS) {
      digitalWrite(LED_PIN, LOW);
      led_state = false;
    }
  }
}
```
</details>

Итак, к обоим модулям подключены платы с МК, модули и платы Arduino запитаны. В результате передатчик будет инициироваться каждую секунду, на подключенной к нему плате Arduino синхронно с передачей будет загораться светодиод, а гидроакустическая антенна будет щелкать.

Для того, чтобы проверить передачу сигнала на воздухе, достаточно расположить излучающую и приемные антенны в непосредственной близости друг от друга, как правило устойчивая работа обеспечивается, если между антеннами не более 10-15 см.

При успешном приеме акустического сигнала, приемный модуль будет инициировать прерывание на плате Arduino и на ней тоже будет загораться светодиод.

Вот как может выглядеть вся лабораторная установка:

| ![image](https://github.com/user-attachments/assets/76dd271a-f87e-45c2-bbad-dad94bc4ccd2) |
| :---: |
| |

При работе на водоеме или в бассейне крайне желательно обеспечивать достаточное заглубление антенн - и излучающая и приемные антенны должны быть опущены не менее 1 метра ниже поверхности воды.

### Сценарий №2 - Собираем приемопередатчик и измеряем наклонную дальность

В ходе данной работы мы соберем два приемопередатчика, один из которых будет выполнять функцию маяка-ответчика, а другой сможет излучать запросный сигнал, ожидать ответный и по времени распространения сигнала и скорости звука определять наклонную дальность между абонентами.

#### Требуемый набор оборудования

| №    | Наименование | Количество | Примечание |
| :--- | :--- | :--- | :--- |
| 1    | Модуль [A<sup>3</sup>R](A3R_Datasheet_ru.md) | 2 |  |
| 2    | Модуль [A<sup>3</sup>T](A3T_Datasheet_ru.md) | 2 |  |
| 3    | Антенна приемопередающая [RT-1.332820-1](/documentation/RU/Transducers/RT_1_332820_1_Specification_ru.md) | 2 |  |
| 4    | Любая плата с МК, например, Arduino Nano | 1 |  |
| 5    | LCD-экран, например MT-204S | 1 | Для отображения измеренного времени и дальности, но можно выводить и в COM-порт |
| 6    | Провода Dupont Female-Female или Male-Female, 25+ см | 4 | |







<div style="page-break-after: always;"></div>
