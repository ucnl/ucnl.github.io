<div style="page-break-after: always;"></div>

| ![logo](/documentation/sm_logo.png) | |
| :---: | ---: |
| [www.unavlab.com](https://www.unavlab.com/) <br/> [support@unavlab.com](mailto:support@unavlab.com) | Инструкция по обновлению прошивки модемов uWave  |

<div style="page-break-after: always;"></div>

# Обновление внутреннего программного обеспечения модемов uWave

> Мы постоянно работаем над улучшением продуктов, учитываем мнения и пожелания пользователей и устраняем обнаруженные недоработки. С историей версий, добавлением  новых функций и исправлениями ошибок вы можете ознакомиться на странице [uWave: История версий и изменений](uWAVE_version_history_ru.md).

## Шаг 1 
Скачайте необходимые утилиты.

### Шаг 1.1 
Скачайте демо-приложение [uWave Host](https://github.com/ucnl/uWAVE_Host/releases/download/1.0/uWAVE_Host.zip) для работы с модемами uWave. Приложение работает на ПК под управлением ОС Windiws (Версии 8 и выше).

### Шаг 1.2 
Скачайте утилиту для обновления прошивки [UCNL_FW_Update](https://github.com/ucnl/UCNL_FW_Update/releases/download/1.1/UCNL_FW_Update.zip). Утилита работает на ПК под управлением OC Windows (Версии 8 и выше).

### Шаг 1.3 
Просто распакуйте скачанные архивы в удобные для вас папки. Оба приложения не требуют установки. 

## Шаг 2
Подготовьте все для подключения модема к ПК.

### Шаг 2.1 
Подключите ваш модем к преобразователю **UART<->USB**. Назначение жил кабеля по цветам представлено ниже:  

| ![uWAVE_wiring_diagram_en](/documentation/uWAVE_wiring_diagram_ru.png) |
| :---: |
| Рисунок 1. Назначение жил кабеля |

Напряжение на линиях данных **НЕ ДОЛЖНО** превышать 3.3 V. 
Для первоначального переключения модема в командный режим необходимо предусмотреть возможность подтяжки жилы SVC/CMD к напряжению 3.3 или 5 Вольт. Это удобно сделать при помощи джампера.

### Шаг 2.2 
Обеспечте возможность удобного включения и выключения командного режима согласно нижеприведенным схемам.

| ![uwave_usb_cmd_mode_off](/documentation/uwave_usb_cmd_mode_off.png) |
| :---: |
| Рисунок 2. Подключение модема к USB-порту ПК при помощи конвертера интерфейса. **Командный режим выключен** |

| ![uwave_usb_cmd_mode_on](/documentation/uwave_usb_cmd_mode_on.png) |
| :---: |
| Рисунок 3. Подключение модема к USB-порту ПК при помощи конвертера интерфейса. **Командный режим включен** |


## Шаг 3
Подключите устройство к USB-порту ПК.

### Шаг 3.1 
Убедитесь, что командый режим не включен (джампер снят, жила **SVC/CMD** притянута к земле - как показано на схеме рис. 2) 

### Шаг 3.2 
Подключите модем к USB-порту ПК при помощи преобразователя:

| ![uwave_and_uart_usb_converter3](/documentation/uwave_and_uart_usb_converter3.png) |
| :---: |
| Рисунок 4. Модем подключен к ПК |

## Шаг 4
Включите настройку **Command mode by default**.

### Шаг 4.1 
Запустите приложение [uWave Host](https://github.com/ucnl/uWAVE_Host/releases/download/1.0/uWAVE_Host.zip)

### Шаг 4.2 
Нажмите кнопку **SETTINGS** на верхней панели инструментов. 

### Шаг 4.3 
В открывшемся окне настроек выберите нужный порт и нажмите кнопку **OK**. 

| ![uwave_host1](/documentation/uwave_host1.png) |
| :---: |
| Рисунок 5. Выбор порта |

### Шаг 4.4
Приложение предложит перезапуститься для применения новых настроек - подтвердите, нажав кнопку **OK**.

### Шаг 4.5 
После перезапуска приложения нажмите кнопку **CONNECT**. 
Если приложению удалось успешно открыть порт, то кнопка **CONNECT** станет выделенной и сменит название на **DISCONNECT** а в текстовом окне **HISTORY WINDOW** отобразится соответствующее сообщение.

Если возникает какая-либо ошибка, убедитесь что порт был выбран правильно и при необходимости вернитесь на [Шаг 4.2]().

### Шаг 4.6
Нажмите кнопку **COMMAND MODE**, сообщив тем самым приложению, что вы собираетесь работать с модемом в командном режиме.

### Шаг 4.7
Переведите модем в командный режим притянув жилу **SVC/CMD** к 3.3 или 5 Вольтам.

### Шаг 4.8
Нажмите кнопку **QUERY** на вкладке **DEVICE INFO**. Если все сделано правильно, то в окнах **HISTORY WINDOW** и текстовом поле на вкладке **DEVICE INFO** отобразится соответствующая информация, например, как на рисунке 6. 

| ![uwave_host2](/documentation/uwave_host2.png) |
| :---: |
| Рисунок 6. Чтение настроек и установка командного режима по умолчанию |

Убедитесь что флажок **Command mode by default** установлен. Если нет, установите его и нажмите кнопку **APPLY** для изменения настроек модема.

Если этого не происходит, закройте порт, нажав кнопку **DISCONNECT** и перейдите к шагу [Шаг 4.2](). Если порт все-таки выбран верно, убедитесь, что в момент подачи питания на модем жила **SVC/CMD** была притянута к земле, т.е. перейдите на [Шаг 3]().

### Шаг 4.9
Закройте приложение [uWave Host](https://github.com/ucnl/uWAVE_Host/releases/download/1.0/uWAVE_Host.zip)

### Шаг 4.10
Притяните жилу **SVC/CMD** к земле.

## Шаг 5
Обновление прошивки устройства

### Шаг 5.1
Если у вас нет файла прошивки для этого модема, обратитесь к [разработчику](mailto:support@unavlab.com) для получения файла прошивки. В письме укажите серийный номер устройства:

| ![uwave_host3](/documentation/uwave_host3.png) |
| :---: |
| Рисунок 7. Серийный номер устройства в окне **DEVICE INFO** |

### Шаг 5.2
Запустите утилиту [UCNL_FW_Update](https://github.com/ucnl/UCNL_FW_Update/releases/download/1.1/UCNL_FW_Update.zip).

### Шаг 5.3
Подключите модем к ПК через преобразователь интерфейса, как показано в [Шаг 3](), убедившись перед подключением в том, что жила **SVC/CMD** притянута к земле.

### Шаг 5.4
В выпадающем списке **Port** выберите соответствуюший устройству порт.

### Шаг 5.5
Выберите соответсвующий устройству файл прошивки, нажав на кнопку **Load**. 
Остальные элементы управления интерфейсом утилиты должны выглядеть как на рисунке 8.:

| ![ucnl_fw_update1](/documentation/ucnl_fw_update1.png) |
| :---: |
| Рисунок 8. Подготовка утилиты **UCNL_FW_Update** к перепрошивке модема **uWave** |

### Шаг 5.6
Запустите процесс обновления прошивки, нажав кнопку **Start**. 

Если:  
* порт выбран правильно
* состояние элементов интерфейса перед началом соответствовало рисунку 8
* файл прошивки соответствует серийному номеру устройства
* перед подачей питания на устройство жила **SVC/CMD** была притянута к земле

То, в нижнем текстовом поле начнет отображаться ход обновления прошивки, как показано на рисунках 9 - 11.

| ![ucnl_fw_update2](/documentation/ucnl_fw_update2.png) |
| :---: |
| Рисунок 9. Начало обновления прошивки |

| ![ucnl_fw_update3](/documentation/ucnl_fw_update3.png) |
| :---: |
| Рисунок 10. Загрузка обновления в устройство |

| ![ucnl_fw_update4](/documentation/ucnl_fw_update4.png) |
| :---: |
| Рисунок 11. Обновление прошивки успешно завершено |

### Шаг 5.7
Закройте приложение и отключите модем от ПК. Обновление завершено.

Если не удается выполнить обновление прошивки устройства, проверьте следующие причины:

* порт выбран неправильно
* состояние элементов интерфейса перед началом не соответствовало рисунку 8
* файл прошивки не соответствует серийному номеру устройства
* перед подачей питания на устройство жила **SVC/CMD** не была притянута к земле
* в процессе обновления прошивки было нарушено подключение

Если обновление не удается выполнить, [свяжитесь с разработчиком](mailto:support@unavlab.com)









